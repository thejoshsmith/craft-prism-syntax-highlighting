{# @var craft \craft\web\twig\variables\CraftVariable #}
{#
/**
 * Prism Syntax Highlighting plugin for Craft CMS 3.x
 *
 * PrismSyntaxHighlightingField Field Input
 *
 * @author    Josh Smith <me@joshsmith.dev>
 * @copyright Copyright (c) 2019 Josh Smith <me@joshsmith.dev>
 * @link      https://www.joshsmith.dev
 * @package   PrismSyntaxHighlighting
 * @since     1.1.0
 */
#}

{% import "_includes/forms" as forms %}

{% set editorHeight = editorHeight * 21 %} {# This is horrible, do something about this... #}
{% if instructions is defined %}
    <div class="heading">
        <div class="instructions">
            <p>{{ instructions }}</p>
        </div>
    </div>
{% endif %}

<div class="js--prism-syntax-highlighting {{ editorThemeClass }}">
    <pre {% if settings.hasEditorPlugin('line-highlight') %}data-line="{{ editorPlugins['line-highlight'] ?? '' }}"{% endif %} spellcheck="false" style="min-height: {{ editorHeight }}px;" class="js--prism-syntax-highlighting-editor prism-syntax-highlighter {% if settings.hasEditorPlugin('line-numbers') %}line-numbers{% endif %}"><code style="tab-size: {{ editorTabWidth }}; -moz-tab-size: {{ editorTabWidth }}; min-height: {{ editorHeight }}px;" class="{% if editorLanguageClass is defined %}{{ editorLanguageClass }}{% endif %}" contenteditable>{% if code|length %}{{ code }}{% endif %}</code></pre>

    {{ forms.textArea({
        class: 'hidden js--prism-syntax-highlighting-textarea',
        id: name~'code',
        name: name~'[code]',
        value: code
    })}}

    <div class="flex prism-syntax-highlighter-settings">
        {{ forms.selectField({
            label: 'Editor Language',
            class: 'prism-syntax-highlighter-settings__setting js--prism-syntax-highlighting-editor-language',
            id: name~'editorLanguage',
            name: name~'[editorLanguage]',
            value: editorLanguage,
            options: settings.getEditorLanguages()
        })}}

        {{ forms.selectField({
            label: 'Editor Theme',
            class: 'prism-syntax-highlighter-settings__setting js--prism-syntax-highlighting-editor-theme',
            id: name~'editorTheme',
            name: name~'[editorTheme]',
            value: editorTheme,
            options: settings.getEditorThemes()
        })}}
    </div>

    {% if settings.hasEditorPlugin('line-highlight') %}
        <div class="flex prism-syntax-highlighter-settings">
            {{ forms.textField({
                label: 'Highlighted Lines',
                id: 'handle',
                name: name~'[editorPlugins][line-highlight]',
                value: editorPlugins['line-highlight'] ?? '',
                on: false})
            }}
            {{ forms.textField({
                label: 'Line Offset',
                id: 'handle',
                name: name~'[editorPlugins][line-highlight-offset]',
                value: editorPlugins['line-highlight-offset'] ?? '',
                on: false})
            }}
            {{ forms.lightswitchField({
                label: 'Linkable',
                id: 'handle',
                name: name~'[editorPlugins][line-highlight]',
                value: editorPlugins['line-highlight'] ?? '',
                on: false})
            }}
        </div>
    {% endif %}

    <hr class="prism-syntax-highlighter-hr">
</div>
